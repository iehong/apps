{yun:}include file="$wapstyle/member/cheader.htm"{/yun}
<link rel="stylesheet" type="text/css" href="{yun:}$wap_style{/yun}/js/webapppic/cropper.css?v={yun:}$config.cachecode{/yun}"/>
<script src="{yun:}$wap_style{/yun}/js/alloy/transform.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$wap_style{/yun}/js/alloy/alloy-finger.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$wap_style{/yun}/js/alloy-crop.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$wap_style{/yun}/js/compress.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$wap_style{/yun}/js/exif.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>

<!-- 页面整体部分 -->
<div id="yunvue" class="none">

    <div class="issue_post_body">
        <form onsubmit="return formSubmitinfo(this)">
            <div class="yun_createbox">
         
				<div class="yun_createlist"@click="openPhoto">
					<div class="yun_create_name"><span class="m_bt">&nbsp;</span>企业logo</div>
					<div class="yun_create_text">
							<div class="yun_create_tx">上传logo赢更多曝光机会</div>
					<div class="yun_create_tximg" >
						<img :src="logo" alt="" width="100%" height="100%">
					</div>
					</div>
				</div>
				
                <div class="yun_createlist">
                  
                        <div class="yun_create_name"><span class="m_bt">*</span>企业名称</div>
						<div class="yun_create_text_p" style="color: #c9c5c5;" v-if="cominfo.yyzz_status==1"> {{cominfo.name}}
                            <input name="name" v-model="cominfo.name" type="hidden">
                        </div>
                        <div class="yun_create_text" v-if="cominfo.yyzz_status!=1">
                            <input name="name" v-model="cominfo.name" placeholder="请输入企业全称" type="text">
                        </div>
                  
                </div>
                <div class="yun_createlist">
                  
                        <div class="yun_create_name"><span class="m_bt">*</span>从事行业</div>
                        <div class="yun_create_select" @click="hyShow=true" v-if="hyIndex">{{hy.name[hyIndex]}}</div>
						<div class="yun_create_select" @click="hyShow=true" v-else  style="color:#cecccc;">请选择从事行业</div>
                        <van-popup v-model="hyShow" position="bottom"/>
                        <van-picker show-toolbar :default-index="hyIndex" @cancel="hyShow = false" :columns="hy.name" @confirm="bindhyChange"/></van-popup>
                        <input hidden="true" name="hy" :value="cominfo.hy?cominfo.hy:0"/>
                  
                  <div class="yun_create_fx">
                  	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                  </div>
                </div>
                <div class="yun_createlist">
                   
                        <div class="yun_create_name"><span class="m_bt">*</span>企业性质</div>
						<div class="yun_create_select" @click="prShow=true" v-if="prIndex">{{pr.name[prIndex]}}</div>
						<div class="yun_create_select" @click="prShow=true" v-else  style="color:#cecccc;">请选择企业性质</div>
						<van-popup v-model="prShow" position="bottom"/>
                        <van-picker show-toolbar :default-index="prIndex" @cancel="prShow = false" :columns="pr.name" @confirm="bindprChange"/></van-popup>
                        <input hidden="true" name="pr" :value="cominfo.pr?cominfo.pr:0"/>
                   
                  <div class="yun_create_fx">
                  	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                  </div>
                </div>
                <div class="yun_createlist">
             
                        <div class="yun_create_name"><span class="m_bt">*</span>企业规模</div>
						<div class="yun_create_select" @click="munShow=true" v-if="munIndex">{{mun.name[munIndex]}}</div>
						<div class="yun_create_select" @click="munShow=true" v-else  style="color:#cecccc;">请选择企业规模</div>
						
                        <van-popup v-model="munShow" position="bottom"/>
                        <van-picker show-toolbar :default-index="munIndex" @cancel="munShow = false" :columns="mun.name" @confirm="bindmunChange"/></van-popup>
                        <input hidden="true" name="mun" :value="cominfo.mun?cominfo.mun:0"/>
                    </div>
                  <div class="yun_create_fx">
                  	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                  </div>
                <div class="yun_createlist">
                 
                        <div class="yun_create_name"><span class="m_bt">*</span>企业地址</div>
						
						<div class="yun_create_text_p" @click="openAddress" v-if="city">{{city}}</div>
						<div class="yun_create_text_p" @click="openAddress"style="color:#cecccc;" v-else>{{nocity}}</div>
						
                  
					
					<div class="yun_create_fx" @click="openAddress" v-if="map_key!=''">
						<img src="{yun:}$wap_style{/yun}/images/issue_location.png" alt="" width="100%" height="100%">
					</div>
					
                  
                </div>
                <div class="yun_createlist">
                  
                        <div class="yun_create_name"><span class="m_bt">*</span>联系人</div>
                        <div class="yun_create_text">
                            <input name="linkman" id="linkman" placeholder="请输入联系人" v-model="cominfo.linkman" onblur="notNumber(this)"/>
                        </div>
                
            
                </div>
                <div class="yun_createlist">
                   
                        <div class="yun_create_name"><span class="m_bt">*</span>手机号</div>
						<div class="yun_create_text_p" style="color: #c9c5c5;"v-if="cominfo.moblie_status == 1">{{cominfo.linktel}}
                            <input name="linktel" v-model="cominfo.linktel" type="hidden"/>
                        </div>
                        <div class="yun_create_text" v-if="cominfo.moblie_status != 1">
                            <input name="linktel" placeholder="请输入联系手机" v-model="cominfo.linktel" oninput="value=value.replace(/^0|[\^d]/g,'')" type="number" maxlength="11"  />
                        </div>
                   
                </div>
                <div class="yun_createlist">
                    
                        <div class="yun_create_name"><span class="m_bt">&nbsp;</span>固定电话</div>
                        <div class="yun_create_text">
                            <input name="linkphone" placeholder="请填写固定电话" v-model="cominfo.linkphone"/>
                        </div>
                  
                </div>
                <div class="yun_createlist">
                        <div class="yun_create_name"><span class="m_bt">*</span>公司简介</div>
                      
						<div class="yun_create_text_p" style="overflow: hidden;text-overflow: ellipsis; white-space: nowrap;width: 5rem" @click="openDec=true" v-if="cominfo.content_t">{{cominfo.content_t}}</div>
						<div class="yun_create_text_p" style="overflow: hidden;text-overflow: ellipsis; white-space: nowrap;width: 5rem" @click="openDec=true"style="color:#cecccc;" v-else>请对企业进行介绍~</div>
						
						
                   <div class="yun_create_fx">
                   	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="">
                    </div>
                </div>
                <div class="yun_createlist" v-if="cominfo.licensecert == 1">
                    <div class="yun_create_name"><span class="m_bt">*</span>企业资质</div>
                    <div class="yun_create_text_p" @click="toCert">
                        <div class="yunCreatSuce">
                            <div class="yunCreatRenzs">
                                <span style="color: #e6a23c; background: #fdf6ec;" v-if="cominfo.cert_status==-1">未认证</span>
                                <span style="color: #409eff; background: #ecf5ff;" v-if="cominfo.cert_status==0">审核中</span>
                                <span style="color: #67c23a; background: #f0f9eb;" v-if="cominfo.cert_status==1">已认证</span>
                                <span style="color: #f56c6c; background: #fef0f0;" v-if="cominfo.cert_status==2">审核未通过</span>
                            </div>
                        </div>
                    </div>
                    <div class="yun_create_fx">
                        <img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="">
                    </div>
                </div>
                <div class="yun_createlist yun_createlistend" @click="supInfoShow=true">
                  
                        <div class="yun_create_name"><span class="m_bt">&nbsp;</span>补充信息</div>
                        <div class="yun_create_text_p"style="color:#cecccc;">让求职者更好的了解企业</div>
                  
                   <div class="yun_create_fx">
                   	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="">
                    </div>
                </div>
            </div>
            <div class="yun_create_bthbox">
                <button type="submit" class="yun_create_bth">保 存</button>
            </div>
        </form>
    </div>

    <van-popup v-model="photoShow" position="right" :style="{ height: '100%',width:'100%',backgroundColor:'#f3f3f3'}">

        <div class="comheader">
            <a class="comheader_return" @click="photoShow = false"></a>
            <div class="comheader_tit">企业LOGO</div>
        </div>
        <div class="verify">
            <div class="photo_i_box_v">
                <div class="photo_i_box_v_c">
                    <div id="showResult">
                        <div id="changeAvatar" class="photo_i_box">
                            <img :src="newLogo ? newLogo :logo"
                                 onerror="showImgDelay(this,'{yun:}$config.sy_ossurl{/yun}/{yun:}$config.sy_unit_icon{/yun}',2);"
                                 width="120" height="120">
                        </div>
                        <div class="clear"></div>
                        <div class="photo_xz">
                            <input id="image" type="file" accept="image/*" onchange="photoChange(this)"/> 选择上传logo

                        </div>
                        <div class="yunset_identity_msg"><i class="yunset_identity_msg_icon"></i>选择上传logo点击提交按钮即可上传
                            <span v-if="cominfo.logo_n">
                                (
                                <font v-if="cominfo.logo_status == '1'" color="red">审核中</font>
                                <font v-else-if="cominfo.logo_status == '2'" color="red">未通过</font>
                                <font v-else color="red">已审核</font>
                                )
                            </span>
                        </div>
                    </div>

                    <input type="hidden" value="" id="preview">
                </div>
                <div class="photo_tj">
                    <input name="submit" type="button" onclick="photo()" value="提交" class="yunset_bth"/>
                </div>
            </div>
        </div>
    </van-popup>

    <van-popup v-model="addressShow" position="bottom">
        <div class="comWapMapAllsd">
            <div class="comheader comheaderFlex">
    			<a class="comheader_return" @click="addressShow = false">
                    <img src="{yun:}$wap_style{/yun}/images/header_back.png?v={yun:}$config.cachecode{/yun}" alt="">         
                </a>
    			<div class="comheader_tit">企业位置</div>
                <span class="comheadSures" @click="jobAddress">确定</span>
            </div>
    		
            <div class="comWapMapSubct">
                    <div class="comWapMapOnes">
    					<div class="comWapMapTwos" v-if="map_key!=''">
                            <div class="body_card_job_box">
                                请单击下方地图完成地址标记
                            </div>
    						<div id="map_container"  style="width:100%;height:280px;overflow: hidden;margin:0;font-family:'微软雅黑';" v-if="map_key!=''"></div>
                        </div>


                        <div class="comWapMapShows">
                            <div class="comWapMapEatel">
                                <div class="yun_createlist"@click="areaShow=true">
                                    <div class="yun_create_name">所在地区</div>
                                    <div class="yun_create_text_p" >
                                        <span v-if="city">{{city}}</span>
                                        <span v-else style="color: #d1d0db">请选择所在地区</span>
                                    </div>
                                    <input hidden="true" name="provinceid" :value="provinceid"/>
                                    <input hidden="true" name="cityid" :value="cityid"/>
                                    <input hidden="true" name="three_cityid" :value="threecityid"/>

                                    <div class="yun_create_fx">
                                        <img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                                    </div>
                                </div>
                                <div class="yun_createlist">
                                        <div class="yun_create_name">详细地址</div>
                                        <div class="yun_create_text">
                                            <input placeholder="建议格式：XX市XX县XX路" v-model="address" id="address" name="address"/>
                                        </div>
                                </div>
                            </div>
                            <div class="comWapMapTishi" v-if="poi.length > 0">
                                <span>可以选择搜索结果设置企业位置</span>
                            </div>
                            <ul>
                                <li v-for="(item,pk) in poi" :key="pk">
                                    <div @click="poiClick(pk)">
                                        <span>{{item.name}}</span>
                                        <b>{{item.address}}</b>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
            </div>
        </div>
    </van-popup>

    <van-popup v-model="openDec" position="right" @open="opendDec"
               :style="{ height: '100%',width:'100%',backgroundColor:'#f3f3f3'}">
        <div class="comheader">
            <a class="comheader_return" @click="openDec = false"></a>
            <div class="comheader_tit">企业简介</div>
        </div>

        <div class="issue_post_body">
            <div class="yun_createbox">
				<div class="yun_create_bjtip">不能填写电话，QQ，微信等联系方式及特殊符号，性别歧视等内容  </div>
                 <div class="yun_createtextarea">
					  <div class="yun_createtextarea_c">
				<textarea :class="isTextarea?'none':''" id="content" placeholder="请对企业进行介绍~" maxlength="-1"
                          style="width:100%;height: 300px;" name="description" :value="cominfo.content"></textarea>
            </div>    </div>
			 </div>

            <div class="yun_create_bthbox">
                <button type="submit" class="yun_create_bth" @click="upDesc">保 存</button>
            </div>
        </div>
    </van-popup>

    <!--城市选择-->
    <van-popup v-model="areaShow" round position="bottom">
        <van-cascader v-model="areaValue" title="请选择工作区域" :options="areaOptions" @close="areaShow = false" @finish="onAreaFinish"/>
    </van-popup>

    <van-popup v-model="supInfoShow" position="right" :style="{ height: '100%',width:'100%',backgroundColor:'#f3f3f3'}">
        <div class="comheader">
            <a class="comheader_return" @click="supInfoShow = false"></a>
            <div class="comheader_tit">补充信息</div>
        </div>
        <!--补充信息弹出-->
        <div class="issue_post_body">
            <form onsubmit="return formSubmit(this)">
                <div class="job_resume_jn_tip">完善信息可让求职者更好的了解企业</div>
                <div class="yun_createbox">
                    <div class="yun_createlist">

                            <div class="yun_create_name">企业简称</div>
                            <div class="yun_create_text">
                                <input name="shortname" placeholder="请输入企业简称" v-model="cominfo.shortname"/>
                            </div>

                    </div>
                    <div class="yun_createlist">

                            <div class="yun_create_name">公司福利</div>

							<div class="yun_create_select"@click="gsflShow=true" v-if="welfareval">{{welfareval}}</div>
							<div class="yun_create_select" @click="gsflShow=true"style="color:#cecccc;" v-else>请选择公司福利</div>

                            <input name="welfare" :value="welfareval?welfareval:''" hidden="true"/>
                        </div>
                       <div class="yun_create_fx">
                       	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                       </div>
                    <div class="yun_createlist">

                            <div class="yun_create_name">企业邮箱</div>
                            <div class="yun_create_text">
                                <input name="linkmail" placeholder="请输入企业邮箱" v-model="cominfo.linkmail" :disabled="cominfo.email_status==1" />
                                <div class="yun_create_tip" v-if="cominfo.email_status == 1">已验证</div>
                            </div>

                    </div>
                    <div class="yun_createlist createlisFlexy">
                            <div class="yun_create_name">传二维码</div>
                            <div class="yun_create_text_p">
                                <div class="yun_create_tx" style="font-size: 12px;">可上传二维码</div>
                                <input type="file" id="pic" name="pic" onchange="previewImage(this,'comqcode')" accept="image/*" value="" style="opacity:0;position: relative;left: -2.9rem;"/>
                                <input type='hidden' name='preview' value='' id='comqcode'>
                            </div>
                            <div class="createImages">
                                <div @click="upComqcode" class="yun_sc_erwm" id="comqcodeshow">
                                    <img id="comqcodeimg" onerror="showImgDelay(this,'{yun:}$config.sy_ossurl{/yun}/{yun:}$config.sy_member_ewm{/yun}',2);" :src="cominfo.comqcode" alt="">
                                </div>
                                <div class="qingchud" v-if="cominfo.comqcode" @click="delcomqcode">清除</div>
                            </div>
                    </div>
                    <div class="yun_createlist">
                            <div class="yun_create_name">企业网址</div>
                            <div class="yun_create_text">
                                <input name="website" placeholder="请输入企业网址" v-model="cominfo.website"/>
                            </div>

                    </div>
                    <div class="yun_createlist">
                            <div class="yun_create_name">联系方式</div>
                            <div class="yun_create_select" @click="lxfsShow=true">
                                {{infostatus.name[infostatusIndex]}}
                            </div>

                            <input hidden="true" name="infostatus" :value="cominfo.infostatus"/>
                      <div class="yun_create_fx">
                      	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                      </div>
                    </div>
                    <div class="yun_createlist yun_time_box not_disturb" v-show="notDisturb">
                        <div class="yun_time_all">
                            <div>
                                <div class="yun_time_name">免扰开始时间</div>
                                <div @click="notStartDisturbShow = true">{{notStartDisturb ? notStartDisturb : '请选择时间'}}</div>
                            </div>
                            <div class="yun_b_z">至</div>
                            <div>
                                <div class="yun_time_name">免扰结束时间</div>
                                <div @click="notEndDisturbShow = true">{{notEndDisturb ? notEndDisturb : '请选择时间'}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="yun_createlist">

                            <div class="yun_create_name">您的职位</div>
                            <div class="yun_create_text">
                                <input name="linkjob" placeholder="请输入你在公司的职位" v-model="cominfo.linkjob"/>
                            </div>

                    </div>
                    <div class="yun_createlist">

                            <div class="yun_create_name">联系QQ</div>
                            <div class="yun_create_text">
                                <input name="linkqq" placeholder="请输入联系QQ" v-model="cominfo.linkqq" oninput="value=value.replace(/^0|[\^d]/g,'')" type="number" />
                            </div>

                    </div>
                    <div class="yun_createlist">

                            <div class="yun_create_name">公交站点</div>
                            <div class="yun_create_text">
                                <input name="busstops" v-model="cominfo.busstops" placeholder="输入公交站点"/>
                            </div>
                        </div>
                    <div class="yun_createlist">
                       
                            <div class="yun_create_name">创办时间</div>


							<div class="yun_create_select"  @click="foundedYearShow = true"style="color:#cecccc;" v-if="!dateValue&&!cominfo.sdate">请选择创办时间</div>
							<div class="yun_create_select"  @click="foundedYearShow = true" v-else-if="dateValue">{{dateValue}}年</div>
							<div class="yun_create_select"  @click="foundedYearShow = true"  v-else>{{cominfo.sdate}}年</div>

                            <input hidden="true" name="sdate" :value="dateValue?dateValue:cominfo.sdate"/>
                     
                      <div class="yun_create_fx">
                      	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                      </div>
                    </div>
                    <div class="yun_createlist">

                            <div class="yun_create_name">注册资金</div>
                            <div class="yun_create_text">

                                <input hidden="true" name="moneytype" :value="cominfo.moneytype"/>
                                <input type="number" name="money" placeholder="请输入注册资本" v-model="cominfo.money" oninput="value=value.replace(/^0|[\^d]/g,'')" />
                                <span class="yun_create_dw" v-if="moneytypeIndex == 1" >万美元</span>
                                <span class="yun_create_dw" v-else>万元</span>
                            </div>


                    </div>
					<div class="yun_createlist yun_createlistend">

					        <div class="yun_create_name">注资单位</div>
							<div class="yun_create_select">
							    <span @click="moneyShow=true">{{moneytype.name[moneytypeIndex]}}</span>
							 </div>	 <div class="yun_create_fx">
                        	<img src="{yun:}$wap_style{/yun}/images/yunfx.png" alt="" width="100%" height="100%">
                        </div></div>
                </div>
                <div class="yun_create_bthbox">
                    <button type="submit" class="yun_create_bth">保 存</button>
                </div>
            </form>
        </div>
    </van-popup>

    <!--公司福利-->
    <van-popup v-model="gsflShow" position="bottom" :closeable="true" @close="gsflShow=false" round>
        <div class="yun_jobadd_touch">
            <div class="jstextarea_tck_c_between">
                <div class="xztextarea_tck_tit">福利待遇</div>
            </div>
            <span v-for="(item, welfarekey) in welfareall" :key="welfarekey">
                <span :class="item.ischecked==1 ? 'flbutton_tab':''" class="flbutton_tabh" @click="bindwelfareChang" :data-index="welfarekey" :id="'w' + (welfarekey + 1)">{{item.name}}</span>
            </span>
            <div class="fl_textbox welfare_box">
                <span class="fl_text welfare_laft">
                    <input type="text" v-model="welfareAdd" name="addwelfare" placeholder="输入福利名称"/>
                </span>
                <span class="fl_but welfare_right">
                    <input type="button" value="添加" @click="bindwelfareAdd"/>
                </span>
            </div>
            <div class="lag_text_qd">
                <div class="lag_text_qd_bth" @click="gsflShow = false">确认</div>
            </div>
        </div>

    </van-popup>
    <!--联系方式-->
    <van-popup v-model="lxfsShow" position="bottom">
        <van-picker show-toolbar :default-index="infostatusIndex" @cancel="lxfsShow = false" :columns="infostatus.name" @confirm="bindinfostatusChange"/>
    </van-popup>
    <!--注册资金-->
    <van-popup v-model="moneyShow" position="bottom">
        <van-picker show-toolbar :default-index="moneytypeIndex" @cancel="moneyShow = false" :columns="moneytype.name" @confirm="bindmoneytypeChange"/>
    </van-popup>
    <!--创办时间-->
    <van-popup v-model="foundedYearShow" position="bottom">
        <van-picker show-toolbar :default-index="foundedYearIndex" @cancel="foundedYearShow = false" :columns="foundedYear" @confirm="bindFoundedYear"/>
    </van-popup>
    <!--免打扰时间-->
    <van-popup v-model="notStartDisturbShow" position="bottom">
            <van-datetime-picker v-model="notStartDisturb" type="time" title="选择时间" @confirm="bindStartNotDisturb" @cancel="notStartDisturbShow = false"/>
    </van-popup>
    <van-popup v-model="notEndDisturbShow" position="bottom">
        <van-datetime-picker  v-model="notEndDisturb" type="time" title="选择时间" @confirm="bindEndNotDisturb" @cancel="notEndDisturbShow = false"/>
    </van-popup>
    <van-popup v-model="certShow" position="right" :style="{ height: '100%',width:'100%',backgroundColor:'#f3f3f3'}">
        <div class="comheader">
            <a class="comheader_return" @click="certShow = false"></a>
            <div class="comheader_tit">企业资质</div>
        </div>
        <div class="wap_member_box">

        <!--状态提示语句-->
        <div v-if="status==-1" class="security">未认证，当前未上传相关企业资质</div>
        <div v-else-if="status==0" class="security">企业资质正在审核中，如需快速审核，请拨打客服服务热线：{yun:}($config.sy_comwebtel!='')?$config.sy_comwebtel:$config.sy_freewebtel{/yun}</div>
        <div v-else-if="status==1" class="security">企业资质已成功认证，若需修改则需要重新审核</div>
        <div v-else-if="status==2" class="security">审核未通过，{{statusBody ? '原因：'+statusBody+'，' : ''}}请重新上传。如有疑问可拨打服务热线：{yun:}($config.sy_comwebtel!='')?$config.sy_comwebtel:$config.sy_freewebtel{/yun}</div>


        <form id="certFrom">

            <ul class="security">
                <li v-if="com_social_credit == 1">
                    <span class="security_anme">信用代码</span>
                    <div class="security_text"><input type="text" v-model="social_credit" class="security_text_t" placeholder="输入统一社会信用代码"></div>
                </li>
            </ul>

            <div class="yunset_identity_box">

                <div class="yunset_identity">
                    <div align="center" class="yunset_identity_pic_img" id="checkshow" :class="photo? '' : 'none'">
                        <img :src="photo" id="checkimg"  />
                    </div>

                    <div class="yunset_identity_pic">
                        <input type="file" onchange="previewImage(this,'check')" accept="image/*" class="yunset_identity_pic_file">
                        <input type='hidden' name='check' value='' id='check'>
                    </div>

                    <i class="yunset_identity_pic_tj"></i>
                    <div class="yunset_identity_tip" style="padding-top:10px;">上传营业执照/组织机构代码证</div>
                    <span class="yunset_identity_tip_a">选择上传图片</span>
                </div>
            </div>

            <div class="yunset_identity_box" v-if="com_cert_owner == 1">

                <div class="yunset_identity">
                    <div align="center" class="yunset_identity_pic_img" id="owner_certshow" :class="photo_owner_cert? '' : 'none'">
                        <img :src="photo_owner_cert" id="owner_certimg" />
                    </div>
                    <div class="yunset_identity_pic">

                        <input type="file" onchange="previewImage(this,'owner_cert')" accept="image/*" class="yunset_identity_pic_file">
                        <input type='hidden' name='owner_cert' value='' id='owner_cert'>
                    </div>
                    <i class="yunset_identity_pic_tj"></i>
                    <div class="yunset_identity_tip" style="padding-top:10px;">上传经办人身份证</div>
                    <span class="yunset_identity_tip_a">选择上传图片</span>
                </div>
            </div>

            <div class="yunset_identity_box" v-if="com_cert_wt == 1">
                <div class="yunset_identity">
                    <div align="center" class="yunset_identity_pic_img" id="wt_certshow" :class="photo_wt_cert? '' : 'none'">
                        <img :src="photo_wt_cert" id="wt_certimg"/>
                    </div>
                    <div class="yunset_identity_pic">

                        <input type="file" onchange="previewImage(this,'wt_cert')" accept="image/*" class="yunset_identity_pic_file">
                        <input type='hidden' name='wt_cert' value='' id='wt_cert'>
                    </div>
                    <i class="yunset_identity_pic_tj"></i>
                    <div class="yunset_identity_tip" style="padding-top:10px;">上传委托书/承诺函</div>
                    <span class="yunset_identity_tip_a">选择上传图片</span>
                </div>

                <div class="yunset_identity_tip_c" style="padding-top:10px;" v-if="exa_cert_wt">委托书/承诺函范本
                    <a href="javascript:void(0);" @click="downFb" style="color:#3b7cff; text-decoration:underline">查看范本</a>
                </div>
            </div>

            <div class="yunset_identity_box" v-if="com_cert_other==1">
                <div class="yunset_identity">
                    <div align="center" class="yunset_identity_pic_img" id="other_certshow" :class="photo_other_cert? '' : 'none'">
                        <img :src="photo_other_cert" id="other_certimg"/>
                    </div>
                    <div class="yunset_identity_pic">
                        <input type="file" onchange="previewImage(this,'other_cert')" accept="image/*" class="yunset_identity_pic_file">
                        <input type='hidden' name='other_cert' value='' id='other_cert'>
                    </div>
                    <i class="yunset_identity_pic_tj"></i>
                    <div class="yunset_identity_tip" style="padding-top:10px;">上传其他证明材料（选填）</div>
                    <span class="yunset_identity_tip_a">选择上传图片</span>
                </div>

                <div class="yunset_identity_tip_c" style="padding-top:10px;">执照中的文字、图片、章印等需清晰可辨别，否则不能通过认证。</div>
                <div class="yunset_identity_msg"><i class="yunset_identity_msg_icon"></i>格式为 {{pic_type}} 不得超过{{file_maxsize}}M</div>

            </div>

            <div class="yunset_bth_box yunset_bth_zzbox">
                <input type="button" value="保存" class="yunset_bth" @click="saveCert">
            </div>
        </form>

    </div>
    </van-popup>
</div>
<link rel="stylesheet" href="{yun:}$wap_style{/yun}/js/umeditor/themes/default/css/umeditor.min.css?v={yun:}$config.cachecode{/yun}" type="text/css"/>
<script src="{yun:}$wap_style{/yun}/js/umeditor/umeditor.config.js?v={yun:}$config.cachecode{/yun}"></script>
<script src="{yun:}$wap_style{/yun}/js/umeditor/umeditor.min.js?v={yun:}$config.cachecode{/yun}"></script>
<script src="{yun:}$wap_style{/yun}/js/jsMath.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$plusstyle{/yun}/city.cache.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$wap_style{/yun}/js/category.js?v={yun:}$config.cachecode{/yun}" language="javascript"></script>
<script src="{yun:}$plusstyle{/yun}/industry.cache.js?v={yun:}$config.cachecode{/yun}"></script>
<script src="{yun:}$plusstyle{/yun}/com.cache.js?v={yun:}$config.cachecode{/yun}"></script>
<script src="{yun:}$wap_style{/yun}/js/comPicker.js?v={yun:}$config.cachecode{/yun}"></script>
{yun:}if $config.map_key{/yun}
<script type="text/javascript">
    window._AMapSecurityConfig = {
        securityJsCode:'{yun:}$config.map_secret{/yun}'
    }
</script>
<script type="text/javascript" src="{yun:}$config.mapurl{/yun}"></script>
{yun:}/if{/yun}
<script>
    function notNumber(obj){
        obj.value = obj.value.replace(/[-_ ]/g,'');// 去掉空格
        if(!obj.value){
            return ;
        }
        var  test = obj.value.replace(/[0-9]/g,'');
        if (!test){
            showToast('联系人不支持全数字', 2);
            obj.value = ''
            $('#linkman').focus()
            return false;
        }else{
            if(/\d/.test(obj.value)){
                if(obj.value.length>8){
                    // obj.value = obj.value.substring(0,8);
                    showToast('联系人填写字数不能超过8个', 2);
                    obj.value = ''
                    $('#linkman').focus()
                    return false;
                }
            }
        }
    }

    var map_key = '{yun:}$config.map_key{/yun}';
    var umeditor = {};
    var cityParam = {
        one_all: false,
        two_all: false,
    };
    var cityData = cityCategory(cityParam);
    var map = null;
    var yunvue = new Vue({
            el: '#yunvue',
            data: {
                signstate: 0,

                islook: false,
                logo: '',
                photoShow: false,
                newLogo: '',
                cominfo: {},
                hy: {
                    id: [],
                    name: []
                },
                hyIndex: 0,
                pr: {
                    id: [],
                    name: []
                },
                prIndex: 0,
                mun: {
                    id: [],
                    name: []
                },
                munIndex: 0,

                // 工作地点选择
                areaShow: false,
                areaValue: 0,
                areaName: '',
                areaOptions: cityData,
				city: '',
				nocity: '请选择所在城市',
                provinceid: 0,
                cityid: 0,
                threecityid: 0,
                setPosition: 0,
                latitude: '',
                longitude: '',
                address: '',

                firstData: {},
                supplementData: {},
                dateValue: '',
                comqcode: '',
                moneytype: {
                    id: [1, 2],
                    name: ['人民币', '美元']
                },
                moneytypeIndex: 0,
                infostatus: {
                    id: [1, 2],
                    name: ['公开', '不公开']
                },
                infostatusIndex: 0,
                welfare: [],
                welfareval: '',
                welfareall: [],
                welfareAdd: '',
                editorCtx: null,
                canEditor: true,
                sdateArr: [0],
                nowtype: '',
                isTextarea: false,
                descshow: false,
                welid: 'w1',

                hyShow: false,
                prShow: false,
                munShow: false,
                addressShow: false,
                supInfoShow: false,
                lxfsShow: false,
                moneyShow: false,
                openDec: false,
                gsflShow: false,

                // 创办时间
                foundedYearShow: false,
                foundedYear: [],
                foundedYearIndex: 0,

                // 免打扰时间
                notDisturb: false,
                notStartDisturbShow: false,
                notStartDisturb: '',
                notEndDisturbShow: false,
                notEndDisturb: '',
				map_key: map_key,

                certShow: false,
                status: '',
                statusBody: '',
                social_credit: '',
                photo: '',
                photo_owner_cert: '',
                photo_wt_cert: '',
                photo_other_cert: '',

                com_social_credit: 0,
                com_cert_owner: 0,
                com_cert_wt: 0,
                com_cert_other: 0,

                exa_cert_wt: '',
                pic_type: '',
                file_maxsize: '',
                cert_status: 0,
				poi: []
            },
            created() {

                this.hy = getHy('请选择从事行业');
                this.pr = getPr(); // 企业性质
                this.pr.id.unshift(0)
                this.pr.name.unshift('请选择企业性质')
                this.mun = getMun();// 企业规模
                this.mun.id.unshift(0)
                this.mun.name.unshift('请选择企业规模')
                this.foundedYear = getFoundedYear(); // 获取创办年

                this.comInfo();
            },
            watch: {
                address: function (value) {
                    this.cominfo.address = value;
                    if (this.map_key !='' && this.addressShow){
                        debounce(this.localsearch(), 1000);
                    }
                },
            },
            methods: {
                // 工作区域选择
                onAreaFinish({selectedOptions}) {
                    this.provinceid = 0;
                    this.cityid = 0;
                    this.threecityid = 0;

                    let cityStr = '';

                    if (selectedOptions[0] && selectedOptions[0].value > 0) {
                        if (selectedOptions[0]) {
                            this.provinceid = selectedOptions[0].value;
                            cityStr += selectedOptions[0].text;
                            this.areaName = selectedOptions[0].text;
                        }
                    }
                    if (selectedOptions[1] && selectedOptions[1].value > 0) {
                        if (selectedOptions[1]) {
                            this.cityid = selectedOptions[1].value;
                            cityStr += ' ' + selectedOptions[1].text;
                            this.areaName = selectedOptions[0].text;
                        }
                    }
                    if (selectedOptions[2] && selectedOptions[2].value > 0) {
                        if (selectedOptions[1]) {
                            this.threecityid = selectedOptions[2].value;
                            cityStr += ' ' + selectedOptions[2].text;
                        }
                    }
                    this.city = cityStr ? cityStr : citydefault;
                    this.areaShow = false;
                },
                localsearch: function () {
                    let that = this;
					if(that.cominfo.address.length > 3){
						$.post('index.php?c=poi', {address: that.cominfo.address}, function(e){
							if(e.status == '1' && e.tips.length > 0){
								that.poi = e.tips;
							}
						}, 'json');
					}
                },
				poiClick: function(key){
					map.clearMap();
					var location = this.poi[key].location;
					var lngLat = location.split(',');
					
					this.longitude = lngLat[0];
					this.latitude = lngLat[1];
					
					var point = new AMap.LngLat(lngLat[0], lngLat[1]);
					map.setZoomAndCenter(17, point);
					var marker = new AMap.Marker({
						position: point
					});
					map.add(marker);
				},
                bindFoundedYear: function (obj) {
                    this.dateValue = obj.date;
                    this.foundedYearShow = false;
                    this.notDisturbShow = false;
                },
                bindStartNotDisturb: function (obj) {
                    this.notStartDisturbShow = false;
                    this.notStartDisturb = obj;
                },
                bindEndNotDisturb: function (obj) {
                    this.notEndDisturbShow = false;
                    this.notEndDisturb = obj;
                },
                comInfo: function () {
                    showLoading();
                    var that = this;
                    $.post('{yun:}url d=wxapp h=com m=info c=getinfo{/yun}', {
                        rand: Math.random(),
                        source: 'wap'
                    }, function (data) {
                        hideLoading();
                        if (data) {
                            let res = data.data;
                            that.cominfo = res;
                            that.logo = res.logo
                            that.city = res.provinceid ? res.job_city_one + ' ' + (res.job_city_two?res.job_city_two:'') + ' ' + (res.job_city_three ? res.job_city_three : '') : that.city
                            that.provinceid = res.provinceid ? parseInt(res.provinceid) : 0;
                            that.cityid = res.cityid ? parseInt(res.cityid) : 0;
                            that.threecityid = res.three_cityid ? parseInt(res.three_cityid) : 0;
                            that.setPosition = res.setPosition == '1' ? 1 : 0;
                            if (res.x && res.y) {
                                that.longitude = res.x;
                                that.latitude = res.y;
                            }
                            that.address = that.cominfo.address
                            that.supplementData = {
                                sdate: res.sdate,
                                linkmail: res.linkmail,
                                shortname: res.shortname,
                                linkqq: res.linkqq,
                                website: res.website,
                                moneytype: res.moneytype,
                                money: res.money,
                                linkjob: res.linkjob,
                                busstops: res.busstops,
                                infostatus: res.infostatus,
                                welfare: res['arraywelfare']
                            }
                            that.notStartDisturb = res.start_not_disturb;
                            that.notEndDisturb = res.end_not_disturb;
                            that.welfareall = res['welfareAll'] ? res['welfareAll'] : [];
                            if (res['arraywelfare'] && res['arraywelfare'].length > 0) {
                                that.welfare = res['arraywelfare'];
                                that.welfareval = res['welfare'];
                            }
                            if (res.moneytype) {
                                if (res.moneytype == 1) {
                                    that.moneytypeIndex = 0;
                                } else if (res.moneytype == 2) {
                                    that.moneytypeIndex = 1;
                                }
                            }
                            if (res.infostatus) {
                                if (res.infostatus == 1) {
                                    that.infostatusIndex = 0;
                                    that.notDisturb = true;
                                } else if (res.infostatus == 2) {
                                    that.infostatusIndex = 1;
                                    that.notDisturb = false;
                                }
                            }
                            if (that.canEditor) {
                                if (res.content) {
                                    let a = setInterval(function () {
                                        if (that.editorCtx) {
                                            clearInterval(a);
                                            that.editorCtx.setContents({
                                                html: res.content
                                            })
                                        }
                                    }, 100);
                                } else {
                                    that.cominfo.content = '';
                                }
                            }

                            // 索引赋值
                            let hyIndex = that.hy.id.indexOf(res.hy ? parseInt(res.hy) : 0);
                            that.hyIndex = hyIndex < 0 ? 0 : hyIndex;
                            let prIndex = that.pr.id.indexOf(res.pr ? parseInt(res.pr) : 0);
                            that.prIndex = prIndex < 0 ? 0 : prIndex;
                            let munIndex = that.mun.id.indexOf(res.mun ? parseInt(res.mun) : 0);
                            that.munIndex = munIndex < 0 ? 0 : munIndex;

                            if (res.sdate) {
                                that.foundedYear.forEach(function (val, index) {
                                    if (val.date == res.sdate) {

                                        that.foundedYearIndex = index;
                                    }
                                });
                            }
                            that.islook = true;
                            $('#yunvue').removeClass('none');
                        }
                    }, 'json');
                },
                bindprChange: function (value, index) {
                    this.prIndex = index;
                    this.cominfo.pr = this.pr.id[index];
                    this.prShow = false;
                },
                bindhyChange: function (value, index) {
                    this.hyIndex = index;
                    this.cominfo.hy = this.hy.id[index];
                    this.hyShow = false;
                },
                bindmunChange: function (value, index) {
                    this.munIndex = index;
                    this.cominfo.mun = this.mun.id[index];
                    this.munShow = false;
                },
                bindinfostatusChange: function (value, index) {
                    this.infostatusIndex = index;
                    this.cominfo.infostatus = this.infostatus.id[index];
                    this.lxfsShow = false;
                    if(index == 0){
                        this.notDisturb = true;
                    } else {
                        this.notDisturb = false;
                    }
                },
                bindmoneytypeChange: function (value, index) {
                    this.moneytypeIndex = index;
                    this.cominfo.moneytype = this.moneytype.id[index];
                    this.moneyShow = false;
                },
                opendDec: function () {
                    umeditor = UM.getEditor('content', {
                        toolbar: false,
                        elementPathEnabled: false,
                        wordCount: false,
                        autoHeightEnabled: false
                    });

                    let that = this;
                    umeditor.addListener('ready', function () {
                        umeditor.setContent(that.cominfo.content)
                    })
                },
                upDesc: function () {
                    var that = this;

                    var content = umeditor.getContent();
                    if (content != "") {
                        that.cominfo.content = content;
                        that.cominfo.content_t = content.replace(/<\/?.+?>/g, "").replace(/ /g, "");
                    } else {
                        that.cominfo.content = '';
                        that.cominfo.content_t = '';
                    }
                    that.openDec = false;
                },
                openAddress: function () {
                    this.addressShow = true;
                    let that = this;
					if (that.map_key !=''){
						setTimeout(() => {
							if (!map) {
								map = new AMap.Map("map_container");
								// 			// 解决移动端 click事件点击无效
								map.on("touchmove", function (e) {
									map.setStatus({
										dragEnable: true
									});
								});
								//  触摸结束时触发次此事件  此时开启禁止拖动
								map.on("touchend", function (e) {
									map.setStatus({
										dragEnable: false
									});
								});
								// 初始化地图 禁止拖动   注：虽禁止拖动，但是可以出发拖动事件
								map.setStatus({
									dragEnable: false
								});
							}else{
								map.clearMap();
							}

							if (that.latitude && that.longitude) {
								var point = new AMap.LngLat(that.longitude, that.latitude);
								map.setZoomAndCenter(17, point);
								var marker = new AMap.Marker({
									position: point
								});
								map.add(marker);
							} else {
								AMap.plugin('AMap.Geolocation', function() {
								   var geolocation = new AMap.Geolocation();
								
								  geolocation.getCurrentPosition(function(status,result){
										if(status=='complete' && result.info == 'SUCCESS'){
											var position = result.position;
                                            map.setZoomAndCenter(17, new AMap.LngLat(position.lng, position.lat));
										}
								  });
								});
							}
							setTimeout(() => {
								map.on("click", function (e) {
									var lngLat = e.lnglat;
									that.latitude = lngLat.lat;
									that.longitude = lngLat.lng;
									map.clearMap();
									var marker = new AMap.Marker({
										position: new AMap.LngLat(lngLat.lng, lngLat.lat)
									});
									map.add(marker);
								});
							}, 500)
						}, 600)
					}
                },
                bindwelfareChang: function (e) {
                    let that = this,
                        windex = '',
                        index = e.currentTarget.dataset.index,
                        welfareall = that.welfareall,
                        welfare = that.welfare;
                    if (welfareall[index]['ischecked'] != 1) {
                        welfareall[index]['ischecked'] = 1;
                        welfare.push(welfareall[index]['name']);
                    } else {
                        welfareall[index]['ischecked'] = 0;
                        windex = welfare.indexOf(welfareall[index]['name']);

                        if (windex > -1) {
                            welfare.splice(windex, 1);
                        }
                    }

                    that.welfare = welfare;
                    that.welfareval = welfare.join(',');
                    that.welfareall = welfareall;
                },
                bindwelfareAdd: function (e) {
                    let that = this,
                        welfareAdd = that.welfareAdd,
                        welfareall = that.welfareall,
                        welfareval = that.welfareval.split(','),
                        welnameall = [];

                    for (let i in welfareall) {
                        welnameall.push(welfareall[i]['name']);
                    }

                    if ($.trim(welfareAdd)!= '' && welfareAdd.length >= 2 && welfareAdd.length <= 8) {
                        //判断信息是否已经存在
                        if (welnameall.indexOf(welfareAdd) > -1) {
                            showModal('相同福利信息已存在，请重新填写');
                            return;
                        }

                        welfareall.push({
                            'name': welfareAdd,
                            'ischecked': 1
                        });
                        welfareval.push(welfareAdd);

                        that.welfareall = welfareall;
                        that.welfareval = welfareval.join(',');
                        that.welfareAdd = '';
                        that.welid = 'w' + welfareall.length;
                    } else {
                        showModal('请输入2-8个福利字符！');
                    }
                },

                sign: function () {
                    showLoading();
                    var self = this;
                    $.post('{yun:}url d=wxapp h=com m=index c=sign{/yun}', {rand: Math.random()}, function (res) {
                        hideLoading();
                        if (res.error == 1) {
                            showModal(res.msg, function () {
                                self.signstate = 1;
                            });
                            self.getInfo();
                        } else {
                            showModal(res.msg);
                        }
                    }, 'json');
                },
                jobAdd: function () {
                    showLoading();
                    var self = this;
                    $.post('{yun:}url d=wxapp h=com m=index c=addCheck{/yun}', {rand: Math.random()}, function (res) {
                        hideLoading();
                        if (res.error == 1) {
                            showModal(res.msg, function () {
                                self.signstate = 1;
                            });
                            self.getInfo();
                        } else {
                            showModal(res.msg);
                        }
                    }, 'json');
                },
				delcomqcode: function(){
                    var self = this;
                    showConfirm('确定要清除企业二维码！',function(){
                        showLoading();
                        
                        $.post('{yun:}url d=wxapp h=com m=info c=delcomqcode{/yun}', {rand: Math.random()}, function (res) {
                            hideLoading();
                            if (res.error == 1) {
                                showModal(res.msg, function () {
                                    self.comInfo();
                                });
                            } else {
                                showModal(res.msg);
                            }
                        }, 'json');
                    })
                },
                // 上传头像
                openPhoto: function () {
                    this.photoShow = true
                    
                },
                upComqcode: function() {
                    $("#pic").click();
                },
                toCert: function(){
                    this.certShow = true;
                    this.getCert();
                },
                getCert: function () {
                    var that = this;
                    var param = {
                        rand: Math.random()
                    };
                    showLoading();
                    $.post('{yun:}url d=wxapp h=com m=set c=getCert{/yun}', param, function (data) {
                        hideLoading();
                        if (data) {
                            let res = data.data;
                            that.status = res.status;
                            that.statusBody = res.statusbody;
                            that.cert_status = res.cert_status;

                            if (data.error == 1) {

                                that.social_credit = res.social_credit;
                                that.photo = res.url;
                                that.photo_owner_cert = res.ocurl ? res.ocurl : '';
                                that.photo_wt_cert = res.wturl ? res.wturl : '';
                                that.photo_other_cert = res.otherurl ? res.otherurl : '';
                            }


                            that.com_social_credit = res.com_social_credit;
                            that.com_cert_owner = res.com_cert_owner;
                            that.com_cert_wt = res.com_cert_wt;
                            that.com_cert_other = res.com_cert_other;

                            that.exa_cert_wt = res.exa_cert_wt ? res.exa_cert_wt : '';

                            that.pic_type = res.pic_type;
                            that.file_maxsize = res.file_maxsize;
                        }
                    }, 'json')
                },
                saveCert:function () {
                    var that = this;
                    var v = getFormValue('certFrom');

                    if (that.comName == ''){

                        return showToast('请填写企业全称');
                    }else if (that.social_credit == '' && that.com_social_credit == 1){

                        return showToast('请填写统一社会信用代码');
                    }else if (v.check == '' && that.photo == '') {

                        return showToast('请上传营业执照');
                    } else if (v.owner_cert == '' && that.photo_owner_cert=='' && that.com_cert_owner == 1) {

                        return showToast('请上传经办人身份证');
                    } else if (v.wt_cert == '' && that.photo_wt_cert=='' && that.com_cert_wt == 1) {

                        return showToast('请上传委托书/承诺函');
                    }else {

                        var formData = {
                            name: that.comName,
                            social_credit: that.social_credit
                        };
                        if (v.check){
                            formData.base   =   v.check;
                        }else{
                            formData.check  =   that.photo;
                        }
                        if (v.owner_cert){
                            formData.base_owner_cert    =   v.owner_cert;
                        }else{
                            formData.owner_cert         =   that.photo_owner_cert;
                        }
                        if (v.wt_cert){
                            formData.base_wt_cert       =   v.wt_cert;
                        }else{
                            formData.wt_cert            =   that.photo_wt_cert;
                        }
                        if (v.other_cert){
                            formData.base_other_cert    =   v.other_cert;
                        }else{
                            formData.other_cert         =   that.photo_other_cert;
                        }

                        showLoading('提交中...');
                        $.post('{yun:}url d=wxapp h=com m=set c=saveCert{/yun}', formData, function (data) {
                            hideLoading();
                            if (data.error == 1) {
                                that.certShow = false;
                                if(that.cert_status == 1){
                                    that.cominfo.cert_status = 0;
                                }else{
                                    that.cominfo.yyzz_status = 1;
                                    that.cominfo.cert_status = 1;
                                }
                            } else {
                                showToast(data.msg);
                            }
                        });

                    }
                },
                downFb:function(){
                    window.location.href = this.exa_cert_wt;
                }
            }
        });

    // 裁剪logo
    function toAlloyCrop(pic) {
        let yd = yunvue.$data;
        new AlloyCrop({
            image_src: pic,
            width: 200,
            height: 200,
            output: 1,
            ok: function (base64, canvas) {
                yd.newLogo = base64;
                $("#preview").val(base64);
                // $('#showResult').fadeIn();
            },
            cancel: function () {
                // $('#showResult').fadeIn();
            },
            ok_text: '确定',
            cancel_text: '取消'
        });
    }

    // 上传logo
    function photo() {
        let yd = yunvue.$data;
        var uimage = $("#preview").val();
        if (uimage == '') {
            showToast('请选择图片后再提交');
            return false;
        } else {
            var regS = new RegExp("\\+", "gi");
            uimage = uimage.replace(regS, "#");
            showLoading('上传中');
            $.ajax({
                type: 'POST',
                url: '{yun:}url d=wxapp h=com m=info c=savephoto{/yun}',
                cache: false,
                dataType: 'json',
                data: {
                    uimage: uimage,
                    source: 'wap'
                },
                success: function (data) {
                    hideLoading();
                    if (data.error == 1) {
                        showToast(data.msg, 2, function () {
                            yd.logo = yd.newLogo;
                            yd.newLogo = '';
                            $("#preview").val('');
                            // yd.photoShow = false;
                        });
                    } else {
                        showModal(data.msg);
                    }
                }
            });
        }
    }

    function jobAddress() {
        let yd = yunvue.$data;
        try {
            let provinceid = yd.provinceid,
                cityid = yd.cityid,
                three_cityid = yd.threecityid,
                address = yd.cominfo.address,
                latitude = yd.latitude,
                longitude = yd.longitude;
            if (provinceid == 0) {
                showModal('请选择所在城市');
                return false;
            }
            if (ct[provinceid]) {
                if (cityid == 0) {
                    showModal('所在城市请选择二级类别');
                    return false;
                }
            }
            if (address.length == 0) {
                showModal('请填写企业地址');
                return false;
            }

            if (yd.setPosition == 1 && latitude.length == 0 && longitude.length == 0) {
                showModal('请设置企业地图');
                return false;
            }

            yd.addressShow = false;
        } catch (e) {}
    }

    function isQQ(QQ) {
        var QQreg = /[1-9][0-9]{4,}/;
        if (QQreg.test(QQ)) {
            return true;
        } else {
            return false;
        }
    }

    /**
     * 判断网址格式是否正确
     */
    function check_url(obj) {
        var Reg =
            /^((([hH][tT][tT][pP][sS]?|[fF][tT][pP])\:\/\/)?([\w\.\-]+(\:[\w\.\&%\$\-]+)*@)?((([^\s\(\)\<\>\\\"\.\[\]\,@;:]+)(\.[^\s\(\)\<\>\\\"\.\[\]\,@;:]+)*(\.[a-zA-Z]{2,4}))|((([01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}([01]?\d{1,2}|2[0-4]\d|25[0-5])))(\b\:(6553[0-5]|655[0-2]\d|65[0-4]\d{2}|6[0-4]\d{3}|[1-5]\d{4}|[1-9]\d{0,3}|0)\b)?((\/[^\/][\w\.\,\?\'\\\/\+&%\$#\=~_\-@]*)*[^\.\,\?\"\'\(\)\[\]!;<>{}\s\x7F-\xFF])?)$/;
        if (Reg.test(obj)) {
            return true;
        } else {
            return false;
        }
    }

    function formSubmit(e) {
        var that = this,
            yd = yunvue.$data,
            linkmail = e.linkmail.value,
            linkqq = e.linkqq.value,
            website = e.website.value;

        if (linkmail.length > 0) {
            if (check_email(linkmail) == false) {
                showModal('电子邮箱格式错误');
                return false;
            }
        }
        if (linkqq.length > 0) {
            if (isQQ(linkqq) == false) {
                showModal('QQ格式错误');
                return false;
            }
        }
        if (website.length > 0) {
            if (check_url(website) == false) {
                showModal('网址格式错误');
                return false;
            }
        }
        if(yd.notStartDisturb && !yd.notEndDisturb){
            showModal('请选择免打扰结束时间');
            return false;
        } else if(!yd.notStartDisturb && yd.notEndDisturb){
            showModal('请选择免打扰开始时间');
            return false;
        }

        try {
            let formData = {
                sdate: e.sdate.value,
                notStartDisturb:yd.notStartDisturb,
                notEndDisturb:yd.notEndDisturb,
                linkmail: e.linkmail.value,
                shortname: e.shortname.value,
                linkqq: e.linkqq.value,
                website: e.website.value,
                moneytype: e.moneytype.value,
                money: e.money.value,
                linkjob: e.linkjob.value,
                busstops: e.busstops.value,
                infostatus: e.infostatus.value,
                welfare: e.welfare.value,
            };

            yd.supplementData = formData;
        } catch (e) {}

        yd.supInfoShow = false;
        return false; // 阻止form提交
    }

    function formSubmitinfo(e) {
        var that = this,
            yd = yunvue.$data,
            obj = {
                name: e.name.value,
                hy: e.hy.value,
                pr: e.pr.value,
                mun: e.mun.value,
                linkman: e.linkman.value,
                linktel: e.linktel.value,
                linkphone: e.linkphone.value,
            };
        try {
            if (obj.name.length == 0) {
                showModal('请填写企业名称');
                return false;
            }
            if (obj.hy == 0) {
                showModal('请选择从事行业');
                return false;
            }
            if (obj.pr == 0) {
                showModal('请选择企业性质');
                return false;
            }
            if (obj.mun == 0) {
                showModal('请选择企业规模');
                return false;
            }
            obj.provinceid = yd.provinceid
            obj.cityid = yd.cityid
            obj.three_cityid = yd.threecityid
            obj.address = yd.cominfo.address

            if (obj.provinceid == 0) {
                showModal('请选择所在城市');
                return false;
            }
            if (ct[obj.provinceid]) {
                if (obj.cityid == 0) {
                    showModal('所在城市请选择二级类别');
                    return false;
                }
            }
            if (obj.address.length == 0) {
                showModal('请填写企业地址');
                return false;
            }

            if (yd.setPosition == 1 && yd.latitude.length == 0 && yd.longitude.length == 0) {
                showModal('请设置企业地图');
                return false;
            }

            if (obj.linkman.length == 0) {
                showModal('请填写联系人');
                return false;
            }else {
                var link_man = obj.linkman.replace(/[-_ ]/g,'');// 去掉空格
                if(!link_man){
                    return ;
                }
                var  test = link_man.replace(/[0-9]/g,'');
                if (!test){
                    showModal('联系人不支持全数字');
                    return false;
                }else{
                    if(/\d/.test(link_man)){
                        if(link_man.length>8){
                            showModal('联系人填写字数不能超过8个');
                            return false;
                        }
                    }
                }
            }
/*
            if (obj.linktel.length == 0) {
                showModal('请填写联系手机');
                return false;
            }

            if (obj.linktel.length > 0) {
                if (isjsMobile(obj.linktel) == false) {
                    showModal('联系手机格式错误');
                    return false;
                }
            }
            if (obj.linkphone.length > 0) {
                if (isjsTell(obj.linkphone) == false) {
                    showModal('联系电话格式错误');
                    return false;
                }
            }
*/
            let content = yd.cominfo.content.replace(/<[^>]+>/g, "");
            if (content.trim() == '') {
                showModal('请填写企业简介');
                return false;
            }
            if(yd.cominfo.licensecert == 1 && yd.cominfo.cert_status == -1){
                showModal('请认证企业资质');
                return false;
            }
            // 处理下一步
            yd.firstData = obj;

            let formData = {};
            formData.content = yd.cominfo.content;
            formData.x = yd.longitude;
            formData.y = yd.latitude;
            formData.source = 'wap';

            Object.assign(formData, yd.firstData, yd.supplementData);
            let comqcode = $("#comqcode").val();
            if (comqcode) {
                formData.preview = comqcode;
            }

            showLoading('保存中');
            $.post('{yun:}url d=wxapp h=com m=info c=saveinfo{/yun}', formData, function (data) {
                hideLoading();
                if (data.error == 1) {
                    showModal(data.msg, function () {
                        navigateTo('index.php');
                        // history.go(-1)
                    });
                } else {
                    showModal(data.msg);
                }
            }, 'json')
        } catch (err) {
        }

        return false;
    }
</script>
{yun:}include file="$wapstyle/member/public/remind.htm"{/yun}
<style>
    .jstextarea_tck_c_between {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .xztextarea_tck_tit {
        font-size: 18px;
        color: #333333;
        font-weight: bold;
    }

    .jstextarea_tck_c_between_r {
        width: 22px;
        height: 22px;
    }

    .flbutton {
        display: flex;
        width: 100%;
        box-sizing: border-box;
        flex-wrap: wrap;
    }

    .flbutton_tabh {
        background: #F6F6F6;
        font-size: 13px;
        line-height: 30px;
        padding: 0 18px;
        color: #333333;
        text-align: center;
        display: inline-block;
        margin-right: 7px;
        border-radius: 15px;
        margin-top: 15px;
    }

    .flbutton_tab {
        background: rgba(39, 120, 248, 0.1);
        color: #2778F8;
    }
    .yun_time_name{left: 0.4rem;color: #666;font-size: 0.37333rem;line-height: 1.112rem;}
    .yun_time_box{padding: 0rem 0.4rem 0 0.4rem}
    .yun_time_all{margin-bottom: 0.3rem}
</style>