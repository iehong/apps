{yun:}include file="$wapstyle/member/cheader.htm"{/yun}
<!--账号设置-->
<div class="none" id="yunvue">
    <!-- 页面整体部分 -->
    <div class="issue_post_body_new">
        <div class="issue_post_body_card" style="padding-top: 0px; margin-top: 0px;;">
            <div class="com_set_list" onclick="navigateTo('index.php?c=comcert')">
                <div class="com_set_listname">企业资质</div>
                <div v-if="info.yyzz_status==1">
                    <div class="com_set_listp">企业资质已认证</div>
                    <div class="com_set_ok">已认证</div>
                </div>
                <div class="" v-else-if="info.cert_pic">
                    <div class="com_set_listp" v-if="info.yyzz_status==2" style="color: #f00;">审核未通过</div>
                    <div class="com_set_listp" v-else-if="info.yyzz_status==0" style="color: #00e1b3;">等待管理员审核</div>
                </div>
                <div v-else>
                    <div class="com_set_listp">企业资质未认证</div>
                    <div class="com_set_no">未认证</div>
                </div>
                <div class="com_set_listicon">
                    <img src="{yun:}$wap_style{/yun}/images/issue_add.png" alt="">
                </div>
            </div>
            <div class="com_set_list" onclick="navigateTo('index.php?c=bindingbox&type=moblie')">
                <div class="com_set_listname">手机号码</div>
                <div class=" ">
                    <div class="com_set_listp" v-if="info.linktel">{{info.linktel}}</div>
                    <div class="com_set_listp" v-else>用于登录和找回密码</div>
                    <div class="com_set_ok" v-if="info.moblie_status==1">已绑定</div>
                    <div class="com_set_no" v-else>未绑定</div>
                </div>
                <div class="com_set_listicon">
                    <img src="{yun:}$wap_style{/yun}/images/issue_add.png" alt="">
                </div>
            </div>
            <div class="com_set_list" onclick="navigateTo('index.php?c=bindingbox&type=email')">
                <div class="com_set_listname">电子邮箱</div>
                <div class=" ">
                    <div class="com_set_listp" v-if="info.linkmail">{{info.linkmail}}</div>
                    <div class="com_set_listp" v-else>用于登录和找回密码</div>
                    <div class="com_set_ok" v-if="info.email_status==1">已绑定</div>
                    <div class="com_set_no" v-else>未绑定</div>
                </div>
                <div class="com_set_listicon">
                    <img src="{yun:}$wap_style{/yun}/images/issue_add.png" alt="">
                </div>
            </div>
            <div>
                <ul class="bingding_box" style="padding: 0">
                    {yun:}if $config.wx_rz=='1'{/yun}
                    <li>
                        <div class="bingding_box_iconbg" :class="bind.wxbind ? 'bingding_yx_g':''"><i class="bingding_box_iconwx"></i></div>
                        <div class="bingding_box_name">微信绑定</div>
                        <template v-if="bind.wxbind == 1">
                            <div class="bingding_box_p">你已绑定微信，下次你可以直接使用微信快捷登录</div>
                            <span @click="bindClear('weixin')" class="bingding_box_bth_jc">解除绑定</span>
                        </template>
                        <template v-else>
                            <span v-if="bind.wxbind == 2" class="bingding_box_bth" onclick="tobind('{yun:}url m=wap c=wxconnect login=1{/yun}')">重新绑定</span>
                            <span v-else class="bingding_box_bth" onclick="tobind('{yun:}url m=wap c=wxconnect login=1{/yun}')">立即绑定</span>
                            <div class="bingding_box_p">绑定微信，下次你可以直接使用微信快捷登录</div>
                        </template>
                    </li>
                    {yun:}/if{/yun}

                    {yun:}if $config.sy_qqlogin=='1'{/yun}
                    <li>
                        <div class="bingding_box_iconbg" :class="bind.qqbind ? 'bingding_yx_qq':''"><i class="bingding_box_iconqq"></i></div>
                        <div class="bingding_box_name">QQ绑定</div>
                        <template v-if="bind.qqbind == 1">
                            <div class="bingding_box_p">你已绑定QQ号，下次你可以直接使用QQ快捷登录</div>
                            <span @click="bindClear('qq')" class="bingding_box_bth_jc">解除绑定</span>
                        </template>
                        <template v-else>
                            <span class="bingding_box_bth" onclick="tobind('{yun:}url m=qqconnect login=1{/yun}')">立即绑定</span>
                            <div class="bingding_box_p">绑定QQ号，下次你可以直接使用QQ快捷登录</div>
                        </template>
                    </li>
                    {yun:}/if{/yun}
                    {yun:}if $config.sy_sinalogin=='1'{/yun}
                    <li>
                        <div class="bingding_box_iconbg" :class="bind.sinabind ? 'bingding_yx_xl':''"><i class="bingding_box_iconxl"></i></div>
                        <div class="bingding_box_name">新浪微博绑定</div>
                        <template v-if="bind.sinabind == 1">
                            <div class="bingding_box_p">你已绑定新浪微博，下次你可以直接使用新浪微博快捷登录</div>
                            <span @click="bindClear('sina')" class="bingding_box_bth_jc">解除绑定</span>
                        </template>
                        <template v-else>
                            <span class="bingding_box_bth" onclick="tobind('{yun:}url m=wap c=sinaconnect login=1{/yun}')">立即绑定</span>
                            <div class="bingding_box_p">绑定新浪微博，下次你可以直接使用新浪微博快捷登录</div>
                        </template>
                    </li>
                    {yun:}/if{/yun}


                    {yun:}if $config.wx_rz != '1' && $config.sy_qqlogin != '1' && $config.sy_sinalogin != '1'{/yun}
                    <div class="wap_member_no">
                        网站未开启第三方绑定，请联系管理员反馈
                    </div>
                    {yun:}/if{/yun}

                </ul>
            </div>
        </div>
    </div>
    <script>
        new Vue({
            el: '#yunvue',
            data: {
                info: {},
                showList: [],
                bind: {},

            },
            created() {
                this.getInfo();
                this.getBindInfo();
                this.getShowLis();
            },
            methods: {
                getInfo: function () {
                    showLoading();
                    var self = this;
                    $.post('{yun:}url d=wxapp h=com m=info c=getinfo{/yun}', {rand: Math.random()}, function (res) {
                        hideLoading();
                        self.info = res.data;
                        $("#yunvue").css('display', 'block');
                    }, 'json');
                },
                getBindInfo() {
                    var self = this;
                    showLoading();
                    $.post('{yun:}url d=wxapp h=com m=set c=getBind{/yun}', {provider: 'h5'}, function (res) {
                        hideLoading();
                        self.bind = res.data;
                        $('#yunvue').removeClass('none');
                    })
                },
                getShowLis: function () {
                    var that = this;
                    $.post('{yun:}url d=wxapp h=com m=info c=show pageSize=2{/yun}', {rand: Math.random()}, function (data) {
                        if (data) {
                            that.showList = data.data.list;
                        }
                    }, 'json');
                },
                bindClear(type) {
                    showConfirm('确定要解除绑定吗？', function () {
                        showLoading();
                        $.post('{yun:}url d=wxapp h=com m=set c=binding{/yun}', {
                            provider: 'h5',
                            isbind: 1,
                            type: type
                        }, function (res) {
                            showToast('解除成功', 2, function () {
                                window.location.reload();
                            })
                        })
                    })
                }
            }
        })
        function tobind(url) {
            throttle(function () {
                window.location.href = url;
            });
        }
    </script>
    </body>
    </html>